from PIL import Image


def serach_malware(path):
    binary_save = []
    input_data = open(path, "rb")
    data = input_data.read(1)

    while data != b"":
        for i in data:
            binary_save.append(i)
        data = input_data.read(1)

    return binary_save

def vlsualization_malware(dataset, outputfile, width=0):
    global size
    if(width == 0):
        size = len(dataset)
        if (size < 10240):
            width = 32
        elif (10240 <= size <= 10240 * 6):
            width = 64
        elif (10240 * 3 <= size <= 10240 * 6):
            width = 128
        elif (10240 * 6 <= size <= 10240 * 10):
            width = 256
        elif (10240 * 10 <= size <= 10240 * 20):
            width = 384
        elif (10240 * 20 <= size <= 10240 * 50):
            width = 512
        elif (10240 * 50 <= size <= 10240 * 100):
            width = 768
        else:
            width = 1024

    heigher = int(size / width) + 1

    image = Image.new("L", (width, heigher))
    image.putdata(dataset)

    imagename = outputfile + ".png"
    image.save(imagename)
    image.show()
    print(imagename + "good")


if __name__ == "__main__":
    path = r"C:\Users\ssky1\PycharmProjects\Deep_Project\chromedriver_win32.zip"
    print(serach_malware(path))
    vlsualization_malware(dataset=serach_malware(path), outputfile=path)
